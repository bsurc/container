bootstrap: docker
from: mambaorg/micromamba:1.5.8-bookworm-slim

%environment
    export MAMBA_DOCKERFILE_ACTIVATE=1
    export ENV_NAME=cautorift

%post
    apt update && apt install -y libgl1
    apt clean
    micromamba create -n cautorift -c conda-forge python autorift notebook \
        matplotlib pandas opencv rasterio
    micromamba clean --all --yes
    export AUTORIFT=/opt/conda/envs/cautorift/lib/python3.12/site-packages/autoRIFT/autoRIFT.py
    sed -i 's/np.bool/bool/g' $AUTORIFT
    sed -i 's/np.int/int/g' $AUTORIFT
